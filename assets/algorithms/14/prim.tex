%&../preamble

% \documentclass[varwidth=6in]{standalone}
% \usepackage{../preamble}

% arara: pdflatex: { synctex: no }
% arara: latexmk: { clean: partial }
\ifstandalone
\begin{document}
\NoCaptionOfAlgo
\begin{algorithm}[H]
\caption[Algoritmo di Prim]{}
\fi

\prototype{\prim{\Graph \(G\), \Node \(r\), \Array{\Int} \(p\)}}{
	\tcp{\(r\): nodo dalla quale parto}
	\tcp{\(p\): vettore dei padri}

	\BlankLine
	\Heap \(Q\) \Assign \minHeapConstructor\;
	\PriorityItem{} \Pos \Assign \new \PriorityItem{1\dots G.n}\;

	\BlankLine
	% \tcp{Per ciascun nodo appartenente al grafo, esclusa la radice che ne fa già parte}
	\tcp{inserisco i nodi nella coda, memorizzando la loro posizione}
	\lnl{prim:init}%
	\ForEach{\(u \in G.\VV() - \{ r \}\)}{
		% \tcp{li inserisco, memorizzando la loro posizione, nella coda indicando che devono ancora essere raggiunti (\(+\infty\))}
		\(\ArrayCall{\Pos}{u} \Assign Q.\heapInsert(u, +\infty)\)\;
	}

	\BlankLine
	\tcp{Inserisco il "nodo di partenza"}
	\(\ArrayCall{\Pos}{r} \Assign Q.\heapInsert{r, 0}\)\;
	\(\ArrayCall{p}{r} \Assign 0\) \Comment*[l]{convenzione per indicare che non ha padre}

	\BlankLine
	\lnl{prim:ciclo-esterno}%
	\While(\Comment*[h]{non ci sono più nodi}){\Not \(Q\).\setEmpty}{

	\BlankLine
		\Node \(u\) \Assign \(Q\).\heapDeleteMin \Comment*[l]{cancello e restituisco il nodo}
		\(\ArrayCall{\Pos}{u} \Assign \Nil\) \Comment*[h]{non considero più quel nodo}\;

		\BlankLine
		\tcp{per ciascun nodo adiacente a quello considerato}
		\lnl{prim:ciclo-interno}%
		\ForEach{\(v \in G.\adj(u)\)}{

			\BlankLine
			\If{\(\ArrayCall{\Pos}{v} \Neq \Nil\) \And \(\weight{u,v} < \ArrayCall{\Pos}{v}.\priority\)}{
				\tcp{\(\ArrayCall{\Pos}{v} \Neq \Nil\): è già stato visitato}
				\tcp{\(\weight{u,v} < \ArrayCall{\Pos}{v}.\priority\): }

				\BlankLine
				\(Q.\heapDecrease{\ArrayCall{Pos}{v}, \weight{u,v}}\) \Comment*[l]{commento}
				\(p[v] \Assign u\) \Comment*[l]{commento}
			}
		}
	}
}

\ifstandalone
\end{algorithm}
\RestoreCaptionOfAlgo
\end{document}
\fi
